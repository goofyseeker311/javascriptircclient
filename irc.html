<html>

<head>
  <title>IRC client</title>
</head>

<body>
<table>
<tr>
  <td colspan="2"><textarea id="irc" name="irc" rows="20" cols="80" readonly style="resize: none;"></textarea></td>
</tr>
<tr>
  <td><input type="text" size="74"></td><td><button type="button">Send</td>
</tr>
</table>
</body>

<script>
const socket = new WebSocket('wss://localhost/wsirc');

socket.onopen = function(event) {
  // Handle connection open
  console.log("Connection open.");
  //sendMessage("nick guest"+Math.floor(Math.random()*10000000));
  //sendMessage("user guest guest guest: guest");
};

socket.onmessage = function(event) {
  // Handle received message
  reader = new FileReader();
  reader.onload = function(e) {
    messagetext = reader.result;
    document.getElementById("irc").value += messagetext;
    console.log("Message from server: ", messagetext);
  };
  reader.readAsText(event.data);
};

socket.onclose = function(event) {
  // Handle connection close
  messagetext = "Connection open.";
};

function sendMessage(message) {
  socket.send(message);
  console.log("Message to server: ", message);
}
</script>

</html>
